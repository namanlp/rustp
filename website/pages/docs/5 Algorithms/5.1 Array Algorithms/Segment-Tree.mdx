---
title: Create Segment Tree
section: 5.1 Array Algorithms
order: 2
slug: /array-algorithms/create-segment-tree/
description: Create Segment Tree for range queries.
---

# Introduction to Segment Tree
and program to create a segment tree in Rust

## Introduction

The Segment Tree is a commonly used tree like data structure that is used for **range based queries**.

By using the Segment Tree, we can reduce the time taken for each range query to **O(log n )**, that takes **O( n )** otherwise.

The example of range queries on a given array are :

1. Sum of integers in a given range.
2. Bitwise OR and AND of integers in given range.
3. Minimum and Maximum in a given range.

If you got any of these queries to perform in Logarithmic time, segment tree is a good option.

## Size of Segment Tree

For a given array containing **n** integers, size of segment tree is

* 2n-1 : If n is a power of 2
* 2k-1 : If n is not the power of 2, and k is the smallest power of 2 greater than n.

So, for example, if n = 9 => k = 16, and hence, size of segment tree = 31.

Also, it is not hard to see that space complexity of a segment tree = **O( n )**

Here is the function to calculate the height of a Segment Tree in Rust

```rust
fn calc_size(n:usize)->usize{
    // If n is a power of 2, return 2n-1
    if n.count_ones() == 1 {
        // Left shift is used to multiply n by 2.
        return (n<<1)-1;
    }

    // If n is not the power of 2, we have to take 2*k - 1
    // k can be calculated by 2^(position of MSB+1)
    // For example, for n = 7, position of MSB = 2, so k = 8
    // Hence k = 2^(64 - leading zeroes)

    let k = 1<<(64 - n.leading_zeros());
    return (k<<1)-1;
}
```

